<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multispecies Unit &mdash; Flash-X 0.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Physical Constants Unit" href="PhysicalConstants.html" />
    <link rel="prev" title="Runtime Parameters Unit" href="RuntimeParameters.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Flash-X
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="arch.html">Overview of Flash-X architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">The Flash-X configuration script (<code class="docutils literal notranslate"><span class="pre">setup</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver.html">Driver Unit</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="infrastructure.html">Infrastructure</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Grid.html">Grid Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="IO.html">IO Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="RuntimeParameters.html">Runtime Parameters Unit</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multispecies Unit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-species">Defining Species</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initializing-species-information-in-simulation-initspecies">Initializing Species Information in <code class="docutils literal notranslate"><span class="pre">Simulation_initSpecies</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifying-constituent-elements-of-a-species">Specifying Constituent Elements of a Species</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alternative-method-for-defining-species">Alternative Method for Defining Species</a></li>
<li class="toctree-l3"><a class="reference internal" href="#routine-descriptions">Routine Descriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-usage">Example Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unit-test">Unit Test</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="PhysicalConstants.html">Physical Constants Unit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="physics.html">Physics Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitor.html">Monitor Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flash-X</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="infrastructure.html">Infrastructure</a> &raquo;</li>
      <li>Multispecies Unit</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Multispecies.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="multispecies-unit">
<span id="chp-multispecies-unit"></span><h1>Multispecies Unit<a class="headerlink" href="#multispecies-unit" title="Permalink to this headline"></a></h1>
<p>Flash-X has the ability to track multiple fluids, each of which can have
its own properties. The <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code> unit handles setting and
querying on the properties of fluids, as well as some common operations
on properties. The advection and normalization of species is described
in the context of the Hydro unit in .</p>
<section id="defining-species">
<span id="sec-defining-species"></span><h2>Defining Species<a class="headerlink" href="#defining-species" title="Permalink to this headline"></a></h2>
<p>The names and properties of fluids are accessed by using their constant
integer values defined in the <code class="docutils literal notranslate"><span class="pre">Simulation.h</span></code> header file. The species
names are defined in a <code class="docutils literal notranslate"><span class="pre">Config</span></code> file. The names of the species, for
example <code class="docutils literal notranslate"><span class="pre">AIR</span></code>, <code class="docutils literal notranslate"><span class="pre">NI56</span></code>, are given in the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file with keyword
<code class="docutils literal notranslate"><span class="pre">SPECIES</span></code>.</p>
<p>In the traditional method for defining species, this <code class="docutils literal notranslate"><span class="pre">Config</span></code> would
typically be the application’s <code class="docutils literal notranslate"><span class="pre">Config</span></code> file in the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>
unit. In the alternative method described below in , <code class="docutils literal notranslate"><span class="pre">SPECIES</span></code> are
normally not listed explicitly in the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> unit <code class="docutils literal notranslate"><span class="pre">Config</span></code>,
but instead are automatically generated by
<code class="docutils literal notranslate"><span class="pre">Multispecies/MultispeciesMain/Config</span></code> based on the contents of the
<code class="docutils literal notranslate"><span class="pre">species</span></code> setup variable. Either way, the <code class="docutils literal notranslate"><span class="pre">setup</span></code> procedure
transforms those names into accessor integers with the appended
description <code class="docutils literal notranslate"><span class="pre">_SPEC</span></code>.</p>
<p>These names are stored in the <code class="docutils literal notranslate"><span class="pre">Simulation.h</span></code> file. The total number of
species defined is also defined within <code class="docutils literal notranslate"><span class="pre">Simulation.h</span></code> as <code class="docutils literal notranslate"><span class="pre">NSPECIES</span></code>,
and the integer range of their definition is given by <code class="docutils literal notranslate"><span class="pre">SPECIES_BEGIN</span></code>
and <code class="docutils literal notranslate"><span class="pre">SPECIES_END</span></code>. To access the species in your code, use the index
listed in <code class="docutils literal notranslate"><span class="pre">Simulation.h</span></code>, for example <code class="docutils literal notranslate"><span class="pre">AIR_SPEC</span></code>, <code class="docutils literal notranslate"><span class="pre">NI56_SPEC</span></code>.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">NSPECIES</span></code>, <code class="docutils literal notranslate"><span class="pre">SPECIES_BEGIN</span></code>, and <code class="docutils literal notranslate"><span class="pre">SPECIES_END</span></code> are
always defined, whether a simulation uses multiple species or not (and
whehter the simulation includes the <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code> unit or not).
However, if <code class="docutils literal notranslate"><span class="pre">NSPECIES</span></code><span class="math notranslate nohighlight">\(=0\)</span>, <code class="docutils literal notranslate"><span class="pre">SPECIES_END</span></code> will be less than
<code class="docutils literal notranslate"><span class="pre">SPECIES_BEGIN</span></code>, and then neither of them should be used as an index
into solution vectors.</p>
<p>As an illustration, Figures  and are snippets from a configuration file
and the corresponding section of the Flash-X header file, respectively.
For more information on <code class="docutils literal notranslate"><span class="pre">Config</span></code> files, see ; for more information on
the <code class="docutils literal notranslate"><span class="pre">setup</span></code> procedure, see ; for more information on the structure of
the main header file <code class="docutils literal notranslate"><span class="pre">Simulation.h</span></code>, see .</p>
<div class="shrink docutils container">
<div class="fcodeseg docutils container">
<p># Portion of a Config file for a Simulation SPECIES AIR SPECIES
SF6</p>
</div>
</div>
<div class="shrink docutils container">
<div class="fcodeseg docutils container">
<p>#define SPECIES_BEGIN (NPROP_VARS + CONSTANT_ONE) #define AIR_SPEC
11 #define SF6_SPEC 12 #define NSPECIES 2 #define SPECIES_END
(SPECIES_BEGIN + NSPECIES - CONSTANT_ONE)</p>
</div>
</div>
<div class="flashtip docutils container">
<p>In Flash-X, you found the integer index of a species by using
<code class="docutils literal notranslate"><span class="pre">find_fluid_index</span></code>. In Flash-X, the species index is always
available because it is defined in <code class="docutils literal notranslate"><span class="pre">Simulation.h</span></code>. Use the index
directory, as in
<code class="docutils literal notranslate"><span class="pre">xIn(NAME_SPEC</span> <span class="pre">-</span> <span class="pre">SPECIES_BEGIN</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">=</span> <span class="pre">solnData(NAME_SPEC,i,j,k)</span></code>.</p>
<p>But be careful that the species name is really defined in your
simulation! You can test with</p>
<div class="codeseg docutils container">
<p>if (NAME_SPEC /= NONEXISTENT) then okVariable =
solnData(NAME_SPEC,i,j,k) endif</p>
</div>
</div>
<p>The available properties of an individual fluid are listed in and are
defined in file <code class="docutils literal notranslate"><span class="pre">Multispecies.h</span></code>. In order to reference the properties
in code, you must <code class="docutils literal notranslate"><span class="pre">#include</span></code> the file <code class="docutils literal notranslate"><span class="pre">Multispecies.h</span></code>. The
initialization of properties is described in the following section.</p>
<div class="center docutils container">
<div class="docutils container" id="tbl-multispeciesproperties">
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Properties available through the <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code> unit.</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 32%" />
<col style="width: 44%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Property Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Data type</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p>Number of protons and
neutrons in nucleus</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Z</span></code></p></td>
<td><p>Atomic number</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p>Number of neutrons</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">E</span></code></p></td>
<td><p>Number of electrons</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BE</span></code></p></td>
<td><p>Binding Energy</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GAMMA</span></code></p></td>
<td><p>Ratio of heat capacities</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_ZMIN</span></code></p></td>
<td><p>Minimum allowed average
ionization</p></td>
<td><p>real</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSTYPE</span></code></p></td>
<td><p>EOS type to use for MTMMMT
EOS</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSSUBTYPE</span></code></p></td>
<td><p>EOS subtype to use for
MTMMMT EOS</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSZFREEFILE</span></code></p></td>
<td><p>Name of file with
ionization data</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSENERFILE</span></code></p></td>
<td><p>Name of file with internal
energy data</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSPRESFILE</span></code></p></td>
<td><p>Name of file with pressure
data</p></td>
<td><p>string</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_NUMELEMS</span></code></p></td>
<td><p>Number of elements
comprising this species</p></td>
<td><p>integer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_ZELEMS</span></code></p></td>
<td><p>Atomic number of each
species element</p></td>
<td><p>array(integer)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_AELEMS</span></code></p></td>
<td><p>Mass number of each species
element</p></td>
<td><p>array(real)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_FRACTIONS</span></code></p></td>
<td><p>Number fraction of each
species element</p></td>
<td><p>array(real)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_OPLOWTEMP</span></code></p></td>
<td><p>Temperature at which cold
opacities are used</p></td>
<td><p>real</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="initializing-species-information-in-simulation-initspecies">
<span id="sec-init-species"></span><h2>Initializing Species Information in <code class="docutils literal notranslate"><span class="pre">Simulation_initSpecies</span></code><a class="headerlink" href="#initializing-species-information-in-simulation-initspecies" title="Permalink to this headline"></a></h2>
<p>Before you can work with the properties of a fluid, you must initialize
the data in the <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code> unit. Normally, initialization is done
in the routine <code class="docutils literal notranslate"><span class="pre">Simulation/Simulation_initSpecies</span></code>. An example
procedure is shown below and consists of setting relevant properties for
all fluids/<code class="docutils literal notranslate"><span class="pre">SPECIES</span></code> defined in the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file. Fluids do not
have to be isotopes; any molecular substance which can be defined by the
properties shown in is a valid input to the Multispecies unit.</p>
<div class="shrink docutils container">
<div class="codeseg docutils container">
<p>subroutine Simulation_initSpecies()</p>
<p>implicit none #include “Multispecies.h” #include “Simulation.h”</p>
<p>! These two variables are defined in the Config file as ! SPECIES
SF6 and SPECIES AIR call Multispecies_setProperty(SF6_SPEC, A,
146.) call Multispecies_setProperty(SF6_SPEC, Z, 70.) call
Multispecies_setProperty(SF6_SPEC, GAMMA, 1.09)</p>
<p>call Multispecies_setProperty(AIR_SPEC, A, 28.66) call
Multispecies_setProperty(AIR_SPEC, Z, 14.) call
Multispecies_setProperty(AIR_SPEC, GAMMA, 1.4) end subroutine
Simulation_initSpecies</p>
</div>
</div>
<div class="flashtip docutils container">
<p>For nuclear burning networks, a <code class="docutils literal notranslate"><span class="pre">Simulation_initSpecies</span></code> routine is
already predefined. It automatically initializes all isotopes found
in the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file. To use this shortcut, <code class="docutils literal notranslate"><span class="pre">REQUIRE</span></code> the module
<code class="docutils literal notranslate"><span class="pre">Simulation/SimulationComposition</span></code> in the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file.</p>
</div>
</section>
<section id="specifying-constituent-elements-of-a-species">
<span id="sec-constelems"></span><h2>Specifying Constituent Elements of a Species<a class="headerlink" href="#specifying-constituent-elements-of-a-species" title="Permalink to this headline"></a></h2>
<p>A species can represent a specific isotope or a single element or a more
complex material. Some units in Flash-X require information about the
elements that constitute a single species. For example, water is
comprised of two elements: Hydrogen and Oxygen. The <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code>
database can store a list of the atomic numbers, mass numbers, and
relative number fractions of each of the elements within a given
species. This information is stored in the array properties
<code class="docutils literal notranslate"><span class="pre">MS_ZELEMS</span></code>, <code class="docutils literal notranslate"><span class="pre">MS_AELEMS</span></code>, and <code class="docutils literal notranslate"><span class="pre">MS_FRACTIONS</span></code> respectively. The
property <code class="docutils literal notranslate"><span class="pre">MS_NUMELEMS</span></code> contains the total number of elements for a
species (<code class="docutils literal notranslate"><span class="pre">MS_NUMELEMS</span></code> would be two for water since water is made of
Hydrogen and Oxygen). There is an upper bound on the number of elements
for a single species which is defined using the preprocessor symbol
<code class="docutils literal notranslate"><span class="pre">MS_MAXELEMS</span></code> in the “Simulation.h” header file and defaults to six.
The value of <code class="docutils literal notranslate"><span class="pre">MS_MAXELEMS</span></code> can be changed using the <code class="docutils literal notranslate"><span class="pre">ms_maxelems</span></code>
setup variable. shows an example of how the constituent elements for
water can be set using the <code class="docutils literal notranslate"><span class="pre">Simulation_initSpecies</span></code> subroutine.</p>
<p>The constituent element information is optional and is only needed if a
particular unit of interest requires it. At present, only the analytic
cold opacities used in the <code class="docutils literal notranslate"><span class="pre">Opacity</span></code> unit make use of the constituent
element information.</p>
<div class="shrink docutils container">
<div class="codeseg docutils container">
<p>#include “Simulation.h” #include “Multispecies.h”</p>
<p>! Create arrays to store constituent element data. Note that these
! arrays are always of length MS_MAXELEMS. real ::
aelems(MS_MAXELEMS) real :: fractions(MS_MAXELEMS) integer ::
zelems(MS_MAXELEMS)</p>
<p>call Multispecies_setProperty(H2O_SPEC, A, 18.0/3.0) ! Set average
mass number call Multispecies_setProperty(H2O_SPEC, Z, 10.0/3.0) !
Set average atomic number call Multispecies_setProperty(H2O_SPEC,
GAMMA, 5.0/3.0) call Multispecies_setProperty(H2O_SPEC,
MS_NUMELEMS, 2)</p>
<p>aelems(1) = 1.0 ! Hydrogen aelems(2) = 16.0 ! Oxygen call
Multispecies_setProperty(H2O_SPEC, MS_AELEMS, aelems)</p>
<p>zelems(1) = 1 ! Hydrogen zelems(2) = 8 ! Oxygen call
Multispecies_setProperty(H2O_SPEC, MS_ZELEMS, zelems)</p>
<p>fractions(1) = 2.0/3.0 ! Two parts Hydrogen fractions(2) = 1.0/3.0
! One part Oxygen call Multispecies_setProperty(H2O_SPEC,
MS_FRACTIONS, fractions)</p>
</div>
</div>
</section>
<section id="alternative-method-for-defining-species">
<span id="sec-definespecies2"></span><h2>Alternative Method for Defining Species<a class="headerlink" href="#alternative-method-for-defining-species" title="Permalink to this headline"></a></h2>
<p>described how species can be defined by using the <code class="docutils literal notranslate"><span class="pre">SPECIES</span></code> keyword in
the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file. then described how the properties of the species
can be set using various subroutines defined in the <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code>
unit. There is an alternative to these approaches which uses setup
variables to define the species, then uses runtime parameters to set the
properties of each species. This allows users to change the number and
names of species without modifying the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file and also allows
users to change properties without recompiling the code.</p>
<p>Species can be defined using the <code class="docutils literal notranslate"><span class="pre">species</span></code> setup variable. For
example, to create two species called <code class="docutils literal notranslate"><span class="pre">AIR</span></code> and <code class="docutils literal notranslate"><span class="pre">SF6</span></code> one would
specify <code class="docutils literal notranslate"><span class="pre">species=air,sf6</span></code> in the simulation setup command. Using this
setup variable and using the <code class="docutils literal notranslate"><span class="pre">SPECIES</span></code> keyword in the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file
are mutually exclusive. Thus, the user must choose which method they
wish to use for a given simulation. Certain units, such as the
<code class="docutils literal notranslate"><span class="pre">Opacity</span></code> unit, requires the use of the setup variable.</p>
<p>When species are defined using the setup variable approach, the
<code class="docutils literal notranslate"><span class="pre">Multispecies</span></code> unit will automatically define several runtime
parameters for each species. These runtime parameters can be used set
the properties shown in . The runtime parameter names contain the
species name. shows an example of the mapping between runtime parameters
and <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code> properties, where <code class="docutils literal notranslate"><span class="pre">&lt;spec&gt;</span></code> is replaced by the
species name as specified in the species setup argument list. Some of
these runtime parameters are arrays, and thus the <code class="docutils literal notranslate"><span class="pre">&lt;N&gt;</span></code> is a number
ranging from 1 to <code class="docutils literal notranslate"><span class="pre">MS_MAXELEMS</span></code>. The <code class="docutils literal notranslate"><span class="pre">Simulation_initSpecies</span></code>
subroutine can be used to override the runtime parameter settings.</p>
<div class="center docutils container">
<div class="docutils container" id="tbl-multispeciesrtp">
<p>Parameters</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Property Name</strong></p></th>
<th class="head"><p><strong>Runtime Parameter Name</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;A</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Z</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;Z</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;Neutral</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">E</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;Negative</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">BE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;BindEnergy</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">GAMMA</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;Gamma</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_ZMIN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;Zmin</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSTYPE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">eos_&lt;spec&gt;EosType</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSSUBTYPE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">eos_&lt;spec&gt;SubType</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSZFREEFILE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">eos_&lt;spec&gt;TableFile</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSENERFILE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">eos_&lt;spec&gt;TableFile</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_EOSPRESFILE</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">eos_&lt;spec&gt;TableFile</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_NUMELEMS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;NumElems</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_ZELEMS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;ZElems_&lt;N&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_AELEMS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;AElems_&lt;N&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MS_FRACTIONS</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ms_&lt;spec&gt;Fractions_&lt;N&gt;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MS_OPLOWTEMP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">op_&lt;spec&gt;LowTemp</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
</section>
<section id="routine-descriptions">
<h2>Routine Descriptions<a class="headerlink" href="#routine-descriptions" title="Permalink to this headline"></a></h2>
<p>We now briefly discuss some interfaces to the multifluid database that
are likely of interest to the user. Many of these routines include
optional arguments.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_setProperty</span></code> This routine sets the value
species property. It should be called within the subroutine
<code class="docutils literal notranslate"><span class="pre">Simulation/Simulation_initSpecies</span></code> for all the species of interest
in the simulation problem, and for all the required properties (any
of A, Z, N, E, EB, GAMMA).</p>
<div class="flashtip docutils container">
<p>In Flash-X, you could set multiple properties at once in a call to
<code class="docutils literal notranslate"><span class="pre">add_fluid_to_db</span></code>. In Flash-X, individual calls are required. If
you are setting up a nuclear network, there is a precoded
<code class="docutils literal notranslate"><span class="pre">Simulation/Simulation_initSpecies</span></code> to easily initialize all
necessary species. It is located in the unit
<code class="docutils literal notranslate"><span class="pre">Simulation/SimulationComposition</span></code>, which must be listed in your
simulation <code class="docutils literal notranslate"><span class="pre">Config</span></code> file.</p>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_getProperty</span></code> Returns the value of a
requested property.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_getSum</span></code> Returns a weighted sum of a
chosen property of species. The total number of species can be
subset. The weights are optional, but are typically the mass
fractions <span class="math notranslate nohighlight">\(X_i\)</span> of each of the fluids at a point in space. In
that case, if the selected property (one of <span class="math notranslate nohighlight">\(A_i\)</span>, <span class="math notranslate nohighlight">\(Z_i\)</span>,
…, <span class="math notranslate nohighlight">\(\gamma_i\)</span>) is denoted <span class="math notranslate nohighlight">\({\cal{P}}_i\)</span>, the sum
calculated is</p>
<div class="math notranslate nohighlight">
\[\sum_i {X_i}{\mathcal{P}_i} \quad.\]</div>
</li>
<li><p>Returns the weighted average of the chosen property. As in
<code class="docutils literal notranslate"><span class="pre">Multispecies_getSum</span></code>, weights are optional and a subset of species
can be chosen. If the weights are denoted <span class="math notranslate nohighlight">\(w_i\)</span> and the
selected property (one of <span class="math notranslate nohighlight">\(A_i\)</span>, <span class="math notranslate nohighlight">\(Z_i\)</span>, …,
<span class="math notranslate nohighlight">\(\gamma_i\)</span>) is denoted <span class="math notranslate nohighlight">\({\cal{P}}_i\)</span>, the average
calculated is</p>
<div class="math notranslate nohighlight">
\[\frac{1}{N} \sum_i^N {w_i}{\mathcal{P}_i} \quad,\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the number of species included in the sum; it may
be less than the number of all defined species if an average over a
subset is requested.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_getSumInv</span></code> Same as
<code class="docutils literal notranslate"><span class="pre">Multispecies_getSum</span></code>, but compute the weighted sum of the inverse
of the chosen property. If the weights are denoted <span class="math notranslate nohighlight">\(w_i\)</span> and
the selected property (one of <span class="math notranslate nohighlight">\(A_i\)</span>, <span class="math notranslate nohighlight">\(Z_i\)</span>, …,
<span class="math notranslate nohighlight">\(\gamma_i\)</span>) is denoted <span class="math notranslate nohighlight">\({\cal{P}}_i\)</span>, the sum calculated
is</p>
<div class="math notranslate nohighlight">
\[\sum_i^N \frac{w_i}{\mathcal{P}_i} \quad.\]</div>
<p>For example, the average atomic mass of a collection of fluids is
typically defined by</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\bar{A}} = \sum_i \frac{X_i}{A_i}~,\]</div>
<p>where <span class="math notranslate nohighlight">\(X_i\)</span> is the mass fraction of species <span class="math notranslate nohighlight">\(i\)</span>, and
<span class="math notranslate nohighlight">\(A_i\)</span> is the atomic mass of that species. To compute
<span class="math notranslate nohighlight">\(\bar{A}\)</span> using the multifluid database, one would use the
following lines</p>
<div class="codeseg docutils container">
<p>call Multispecies_getSumInv(A, abarinv, xn(:)) abar = 1.e0 /
abarinv</p>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">xn(:)</span></code> is an array of the mass fractions of each species in
Flash-X. This method allows some of the mass fractions to be zero.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_getSumFrac</span></code> Same as
<code class="docutils literal notranslate"><span class="pre">Multispecies_getSum</span></code>, but compute the weighted sum of the chosen
property divided by the total number of particles (<span class="math notranslate nohighlight">\(A_i\)</span>). If
the weights give the mass fractions <span class="math notranslate nohighlight">\(X_i\)</span> of the fluids at a
point in space and the selected property (one of <span class="math notranslate nohighlight">\(A_i\)</span>,
<span class="math notranslate nohighlight">\(Z_i\)</span>, …, <span class="math notranslate nohighlight">\(\gamma_i\)</span>) is denoted <span class="math notranslate nohighlight">\({\cal{P}}_i\)</span>, the
sum calculated is</p>
<div class="math notranslate nohighlight">
\[\sum_i \frac{X_i}{A_i}{\mathcal{P}_i} \quad.\]</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_getSumSqr</span></code> Same as
<code class="docutils literal notranslate"><span class="pre">Multispecies_getSum</span></code>, but compute the weighted sum of the squares
of the chosen property values. If the weights are denoted <span class="math notranslate nohighlight">\(w_i\)</span>
and the selected property (one of <span class="math notranslate nohighlight">\(A_i\)</span>, <span class="math notranslate nohighlight">\(Z_i\)</span>, …,
<span class="math notranslate nohighlight">\(\gamma_i\)</span>) is denoted <span class="math notranslate nohighlight">\({\cal{P}}_i\)</span>, the sum calculated
is</p>
<div class="math notranslate nohighlight">
\[\sum_i^N {w_i}{\mathcal{P}_i}^2 \quad.\]</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_list</span></code> List the contents of the
multifluid database in a snappy table format.</p></li>
</ul>
</section>
<section id="example-usage">
<h2>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this headline"></a></h2>
<p>In general, to use Multispecies properties in a simulation, the user
must only properly initialize the species as described above in the
<code class="docutils literal notranslate"><span class="pre">Simulation_init</span></code> routine. But to program with the Multispecies
properties, you must do three things:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span></code> the <code class="docutils literal notranslate"><span class="pre">Simulation.h</span></code> file to identify the defined
species</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span></code> the <code class="docutils literal notranslate"><span class="pre">Multispecies.h</span></code> file to identify the desired
property</p></li>
<li><p>use the Fortran interface to the Multispecies unit because the
majority of the routines are overloaded.</p></li>
</ul>
<p>The example below shows a snippet of code to calculate the electron
density.</p>
<div class="codeseg docutils container">
<p>… #include Simulation.h #include Multispecies.h</p>
<p>USE Multispecies_interface, ONLY: Multispecies_getSumInv,
Multispecies_getSumFrac … do
k=blkLimitsGC(LOW,KAXIS),blkLimitsGC(HIGH,KAXIS) do
j=blkLimitsGC(LOW,JAXIS),blkLimitsGC(HIGH,JAXIS) do
i=blkLimitsGC(LOW,IAXIS),blkLimitsGC(HIGH,IAXIS) call
Multispecies_getSumInv(A,abar_inv) abar = 1.e0 / abar_inv call
Multispecies_getSumFrac(Z,zbar) zbar = abar * zbar ye(i,j,k) =
abar_inv*zbar enddo enddo enddo …</p>
</div>
</section>
<section id="unit-test">
<span id="sec-multispeciesunittest"></span><h2>Unit Test<a class="headerlink" href="#unit-test" title="Permalink to this headline"></a></h2>
<p>The unit test for <code class="docutils literal notranslate"><span class="pre">Multispecies</span></code> provides a complete example of how to
call the various API routines in the unit with all variations of
arguments. Within <code class="docutils literal notranslate"><span class="pre">Multispecies/Multispecies_unitTest</span></code>, incorrect
usage is also indicated within commented-out statements.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="RuntimeParameters.html" class="btn btn-neutral float-left" title="Runtime Parameters Unit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="PhysicalConstants.html" class="btn btn-neutral float-right" title="Physical Constants Unit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Flash-X Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>