<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FLASH-X: source/numericalTools/Interpolate/Interpolate_cubic3Dcoeffs.F90 File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../flash-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">FLASH-X
   </div>
   <div id="projectbrief">Doxygen Generated Documentation From Interface Source Code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_f5e562cc3344811ae2d63a2d47961617.html">numericalTools</a></li><li class="navelem"><a class="el" href="../../dir_8641c866cc4b3c626ca7709be337640b.html">Interpolate</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">Interpolate_cubic3Dcoeffs.F90 File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a href="../../d1/de1/Interpolate__cubic3Dcoeffs_8F90_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ab7f3d8efe571d71e27934463cfc54478"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/de1/Interpolate__cubic3Dcoeffs_8F90.html#ab7f3d8efe571d71e27934463cfc54478">Interpolate_cubic3Dcoeffs</a> (numberOfCubes, a)</td></tr>
<tr class="separator:ab7f3d8efe571d71e27934463cfc54478"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ab7f3d8efe571d71e27934463cfc54478" name="ab7f3d8efe571d71e27934463cfc54478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f3d8efe571d71e27934463cfc54478">&#9670;&nbsp;</a></span>Interpolate_cubic3Dcoeffs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine Interpolate_cubic3Dcoeffs </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>numberOfCubes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (1:64,*), intent(inout)&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculates the tricubic expansion coefficients for a collection of cubes. The tricubic expansion reads, for one cube, in terms of rescaled [0,1] x,y,z coordinates:</p>
<p >3 3 3 i j k C (x,y,z) = sum sum sum a (i,j,k) x y z i=0 j=0 k=0</p>
<p >and is uniquely determined by specifying the following 8 values at each of the 8 corners of the cube (64 constraints for 64 unknown expansion coefficients):</p>
<p >C (x,y,z) (value of function at corner) d/dx (1st rescaled x-derivative) d/dy (1st rescaled y-derivative) d/dz (1st rescaled z-derivative) d2/dxdy (2nd mixed rescaled xy-derivative) d2/dxdz (2nd mixed rescaled xz-derivative) d2/dydz (2nd mixed rescaled yz-derivative) d3/dxdydz (3rd mixed rescaled xyz-derivative)</p>
<p >The cube itself is defined by its 0 and 1 coordinates of its 8 corners:</p>
<p >z</p>
<p >| | ----------- | /| y /| / | / / | / | / / | 1 &mdash;&mdash;&mdash;&ndash; | | | | | | 1 &mdash;&mdash;&mdash;&ndash; | / | / | / | / |/ |/ 0 &mdash;&mdash;&mdash;&ndash; &mdash;- x 0 1</p>
<p >In order to obtain the function and global derivative values at a global position (X,Y,Z) inside the cube, one must first form the rescaled x,y,z coordinates:</p>
<p >x = (X - X0) / (X1 - X0) y = (Y - Y0) / (Y1 - Y0) z = (Z - Z0) / (Z1 - Z0)</p>
<p >where X0,Y0,Z0 and X1,Y1,Z1 are the lower and upper global cube x,y,z coordinates:</p>
<p >Z</p>
<p >| | ----------- | /| Y /| / | / / | / | / / | ----------- | /| | | | Y1 &mdash;|&ndash; &mdash;&mdash;&mdash;&ndash; / | / | / Z1 | / | / |/ |/ Y0 &mdash; &mdash;&mdash;&mdash;&ndash; &mdash;- X / | | Z0 X0 X1</p>
<p >The function and global derivative (using the chain rule) values are then:</p>
<p >3 3 3 i j k C (X,Y,Z) = sum sum sum a (i,j,k) x y z i=0 j=0 k=0</p>
<p >3 3 3 i-1 j k d/dX = sum sum sum i * a (i,j,k) x y z * dx/dX i=1 j=0 k=0</p>
<p >3 3 3 i j-1 k d/dY = sum sum sum j * a (i,j,k) x y z * dy/dY i=0 j=1 k=0</p>
<p >3 3 3 i j k-1 d/dZ = sum sum sum k * a (i,j,k) x y z * dz/dZ i=0 j=0 k=1</p>
<p >3 3 3 i-1 j-1 k d2/dXdY = sum sum sum i * j * a (i,j,k) x y z * dx/dX * dy/dY i=1 j=1 k=0</p>
<p >3 3 3 i-1 j k-1 d2/dXdZ = sum sum sum i * k * a (i,j,k) x y z * dx/dX * dz/dZ i=1 j=0 k=1</p>
<p >3 3 3 i j-1 k-1 d2/dYdZ = sum sum sum j * k * a (i,j,k) x y z * dy/dY * dz/dZ i=0 j=1 k=1</p>
<p >3 3 3 i-1 j-1 k-1 d3/dXdYdZ = sum sum sum i * j * k * a (i,j,k) x y z * dx/dX * dy/dY * dz/dZ i=1 j=1 k=1</p>
<p >where the rescaled to global coordinate differentials are:</p>
<p >dx/dX = 1 / (X1 - X0) dy/dY = 1 / (Y1 - Y0) dz/dZ = 1 / (Z1 - Z0)</p>
<p >i.e. the inverses of the corresponding global cube dimensions.</p>
<p >Order of Input --------------</p>
<p >The order of the input values (function + derivatives) must be such, that each function/derivative must have its corner values clustered together in the order shown below. The function + derivatives order must follow the order mentioned above. We thus have the following ordering scheme:</p>
<p >Corners</p>
<p >x y z</p>
<p >/ 0 0 0 C (x,y,z) / 1 0 0 d/dx / 0 1 0 d/dy / 0 0 1 d/dz &lt; 1 1 0 d2/dxdy \ 1 0 1 d2/dxdz \ 0 1 1 d2/dydz \ 1 1 1 d3/dxdydz</p>
<p >Order of Output ---------------</p>
<p >The order of the output coefficients a (i,j,k) is such that the k index has the highest ranking, followed by the j index and the i index. The overall location index of the a (i,j,k) inside the 64-dimensional vector is given by the following formula:</p>
<p >location index of (i,j,k) = 1 + i + 4j + 16k</p>
<p >numberOfCubes : the number of cubes to be treated a (i,j) : i-th function/derivative (input) and expansion coefficient (output) of j-th cube</p>
<p >NOTES</p>
<p >For more information please refer to the following paper: F. Lekien and J. Marsden, International Journal for Numerical Methods in Engineering 63, p.455-471 (2005).</p>
<p >The array holding initially the function + derivative values and later the tricubic expansion coefficients is passed as an assumed size array (using *). This allows for compact looping over all cubes, even if in the calling routine this array is of different shape. The only drawback of this is that array operations on the assumed size array cannot be performed, i.e. every array element must be addressed by specific indices (like a (i,j) for example), which is the case here. Operations like 'a(1,:) = 1.0' or 'size (a,2)' cannot be done!</p>
<p >The code is written entirely without a single multiplication operation. Only the addition and substraction operation is used. This results in an optimum performance.</p>
<p >The code allows for threading to be used on the number of cubes loop. </p>

<p class="definition">Definition at line <a class="el" href="../../d1/de1/Interpolate__cubic3Dcoeffs_8F90_source.html#l00192">192</a> of file <a class="el" href="../../d1/de1/Interpolate__cubic3Dcoeffs_8F90_source.html">Interpolate_cubic3Dcoeffs.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 4 2022 17:05:05 for FLASH-X by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
