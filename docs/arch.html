

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview of Flash-X architecture &mdash; Flash-X 0.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=7026087e"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Performance Portability System" href="orcha.html" />
    <link rel="prev" title="Quick Start" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Flash-X
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="disclaimers.html">Current Status and Disclaimers</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Overview of Flash-X architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#unit">Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flashx-inheritance">Flash-X Inheritance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customization">Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unit-test-framework">Unit Test Framework</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="orcha.html">The Performance Portability System</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">The Flash-X configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeadvance.html">TimeAdvance</a></li>
<li class="toctree-l1"><a class="reference internal" href="infrastructure.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="physics.html">Physics Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitor.html">Monitor Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_section.html">Developer’s Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flash-X</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Overview of Flash-X architecture</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/arch.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="overview-of-flashx-architecture">
<span id="chp-architecture"></span><h1>Overview of Flash-X architecture<a class="headerlink" href="#overview-of-flashx-architecture" title="Link to this heading"></a></h1>
<p>Flash-X is a component based software system where different
permutations and combinations of various components generate different
applications. Some aspects of Flash-X architecture are adapted from
FLASH , but it is fundamentally a new software with an architecture
designed for use with heterogeneous platforms. Portability on
heterogeneous platforms is achieved through
a new <strong>orchestration system for applications</strong> (ORCHA) that is
designed to be language agnostic and adaptable for future changes in
the computing platforms. ORCHA has a collection of tools that address
three main major concerns from the applications perspective described
below.</p>
<p>As mentioned earlier Flash-X is not a monolithic application code;
instead, it should be viewed as a collection of components that are
selectively grouped to form various applications. Users specify which
components should be included in a simulation, define a rough
discretization/parallelization layout, and assign their own initial
conditions, boundary conditions, and problem setup to create a unique
application executable. In Flash-X terminology, a component that
implements an exclusive portion of the code’s functionality is called
a <strong>unit</strong>. A typical Flash-X simulation requires a proper subset of the
units available in the code. Thus, it is important to distinguish
between the entire Flash-X source code and a given Flash-X
application.</p>
<section id="unit">
<span id="sec-unit"></span><h2>Unit<a class="headerlink" href="#unit" title="Link to this heading"></a></h2>
<p>A Flash-X unit provides well-defined functionality and publishes an
Application Programming Interface (API), a collection of routines
through which other units can interact with it. A unit
can have multiple alternative implementations of varying complexity
and for different purposes. A unit can have an arbitrary number of
subunits that provide subsets of the unit’s functionality, though in
practice the number of subunits remains low. Units must include a null
implementation for every routine in their API at the top level of
their hierarchy. This feature permits an application to
easily exclude a unit without the need to modify code elsewhere. For
example, the input/output unit can be easily turned on and off for
testing purposes, by using the null implementations.</p>
<p>Flash-X implements its inheritance, extensibility, and
modularity  through its configuration layer. This layer
consists of a collection of text Config files that reside at various
levels of the code organization, and the setup tool which interprets
the Config files. The two primary functions of this layer are to
configure a single application from the Flash-X source tree, and to
implement inheritance and customizability in the code.</p>
<p>Unit architecture abstracts the computational complexity of
the unit from its public interfaces, and controls the scope of various
data items owned by the unit. A unit’s API provides interfaces for
modifying the state of the solution and for accessing and modifying
data it owns that may be needed by other units.
Units can have one or more subunits which are groupings of
self-contained functionality. The concept subunits
formalizes the selective use of a subset of a unit’s functionality,
and the possibility of multiple alternative implementations of the
same subset.  Subunits implement disjoint subsets of a
unit’s API, where none of the subsets can be a null set. The union of
all subsets constituting various subunits must be exactly equal to the
unit API. Every unit has at least a Main subunit that implements the
bulk of the unit’s functionality, including its initialization. The
Main subunit is also the custodian of all the unit-scope data.
Subunits and other finer-grained components can have their own data
modules that are only visible to the routines and functions within
those components. In other words, a data module placed in a directory
is only visible to routines in functions in that directory or its
sub-directories, but not to its parent or ancestor directories.</p>
</section>
<section id="flashx-inheritance">
<span id="sec-inheritance"></span><h2>Flash-X Inheritance<a class="headerlink" href="#flashx-inheritance" title="Link to this heading"></a></h2>
<p>Flash-X inheritance is implemented through the Unix directory structure
and the setup tool. When the <code class="docutils literal notranslate"><span class="pre">setup</span></code> tool parses the source tree, it
treats each child or subdirectory as inheriting all of the Config and
Makefile files in its parent’s directory. While source files at a given
level of the directory hierarchy override files with the same name at
higher levels, Makefiles and configuration files are cumulative. Since
functions can have multiple implementations, selection for a specific
application follows a few simple rules described in the following
Figures.</p>
<div class="center docutils container">
<blockquote>
<div><figure class="align-default" id="fig-highlevel-flowchart">
<a class="reference internal image-reference" href="_images/overview_flowchart.png"><img alt="overall_flowchart" src="_images/overview_flowchart.png" style="width: 4in;" />
</a>
<figcaption>
<p><span class="caption-text">Overview of the control flow during configuration</span><a class="headerlink" href="#fig-highlevel-flowchart" title="Link to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
<div class="center docutils container">
<figure class="align-default" id="fig-high-inheritance">
<a class="reference internal image-reference" href="_images/overall_inheritance.png"><img alt="overall_inheritance" src="_images/overall_inheritance.png" style="width: 4in;" />
</a>
<figcaption>
<p><span class="caption-text">Overview of the inheritance in various components of the code</span><a class="headerlink" href="#fig-high-inheritance" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="center docutils container">
<figure class="align-default" id="fig-keys-rp">
<a class="reference internal image-reference" href="_images/keys_rp_inheritance.png"><img alt="Inheritance as it applied to keys defining macros and runtime parameters" src="_images/keys_rp_inheritance.png" style="width: 4in;" />
</a>
<figcaption>
<p><span class="caption-text">Overview of the control flow during configuration</span><a class="headerlink" href="#fig-keys-rp" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<div class="center docutils container">
<figure class="align-default" id="fig-file-generation">
<a class="reference internal image-reference" href="_images/file_generation.png"><img alt="Step_file_generation" src="_images/file_generation.png" style="width: 4in;" />
</a>
<figcaption>
<p><span class="caption-text">Steps in arbitration on files to be included/generated</span><a class="headerlink" href="#fig-file-generation" title="Link to this image"></a></p>
</figcaption>
</figure>
</div>
<p>However, we must take care that this special use of the directory</p>
</div>
<p>structure for inheritance does not interfere with its traditional use
for organization. We avoid any problems by means of a careful naming
convention that allows clear distinction between organizational and
namespace directories. See for naming conventions.</p>
</section>
<section id="customization">
<h2>Customization<a class="headerlink" href="#customization" title="Link to this heading"></a></h2>
<p>The Simulation unit in the code is treated differently from all other
units because this is where the application is defined. The parsing of
<em>Config</em> file begins from that of the application being
configured. Additionally, this unit also provides the mechanism for
customization. The inheritance implemented by the <em>setup</em> tool
replaces any file or a macro definition assembled during the
configuration of hte application if another file or macro of the same
name is encountered in the Simulation unit. Thus a user desirous of
customizing any part of the source code can do so by simply placing an
identically named file or macro in a file with “.ini” extenstion in
the directory that they created for their <em>Simulation</em>.</p>
</section>
<section id="unit-test-framework">
<h2>Unit Test Framework<a class="headerlink" href="#unit-test-framework" title="Link to this heading"></a></h2>
<p>In keeping with good software practice, Flash-X incorporates a unit test
framework that allows for rigorous testing and easy isolation of errors.
The components of the unit test show up in two different places in the
Flash-X source tree. One is a dedicated path in the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> unit,
<code class="docutils literal notranslate"><span class="pre">Simulation/SimulationMain/unitTest/UnitTestName</span></code>, where
<em>UnitTestName</em> is the name of a specific unit test. The other place is a
subdirectory called <code class="docutils literal notranslate"><span class="pre">unitTest</span></code>, somewhere in the hierarchy of the
corresponding unit which implements a function <code class="docutils literal notranslate"><span class="pre">Unit_unitTest</span></code> and any
helper functions it may need. The primary reason for organizing unit
tests in this somewhat confusing way is that unit tests are special
cases of simulation setups that also need extensive access to internal
data of the unit being tested. By splitting the unit test into two
places, it is possible to meet both requirements without violating unit
encapsulation. We illustrate the functioning of the unit test framework
with the unit test of the <code class="docutils literal notranslate"><span class="pre">Eos</span></code> unit. For more details please see .
The <code class="docutils literal notranslate"><span class="pre">Eos</span></code> unit test needs its own version of the routine
<code class="docutils literal notranslate"><span class="pre">Driver/Driver_evolveAll</span></code> which makes a call to its <code class="docutils literal notranslate"><span class="pre">Eos_unitTest</span></code>
routine. The initial conditions specification and unit test specific
<code class="docutils literal notranslate"><span class="pre">Driver_evolveAll</span></code> are placed in
<code class="docutils literal notranslate"><span class="pre">Simulation/SimulationMain/unitTest/Eos</span></code>, since the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code>
unit allows any substitute Flash-X function to be placed in the specific
simulation directory. The function <code class="docutils literal notranslate"><span class="pre">Eos_unitTest</span></code> resides in
<code class="docutils literal notranslate"><span class="pre">physics/Eos/unitTest</span></code>, and therefore has access to all internal
<code class="docutils literal notranslate"><span class="pre">Eos</span></code> data structures and helper functions.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="orcha.html" class="btn btn-neutral float-right" title="The Performance Portability System" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Flash-X Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>