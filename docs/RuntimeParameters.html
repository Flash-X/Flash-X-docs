<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Runtime Parameters Unit &mdash; Flash-X 0.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=7026087e"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Multispecies Unit" href="Multispecies.html" />
    <link rel="prev" title="IO Unit" href="IO.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Flash-X
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="disclaimers.html">Current Status and Disclaimers</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="arch.html">Overview of Flash-X architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="orcha.html">The Performance Portability System</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">The Flash-X configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeadvance.html">TimeAdvance</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="infrastructure.html">Infrastructure</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Grid.html">Grid Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="IO.html">IO Unit</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Runtime Parameters Unit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-runtime-parameters">Defining Runtime Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#identifying-valid-runtime-parameters">Identifying Valid Runtime Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#routine-descriptions">Routine Descriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-usage">Example Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Multispecies.html">Multispecies Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="PhysicalConstants.html">Physical Constants Unit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="physics.html">Physics Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitor.html">Monitor Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_section.html">Developer’s Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flash-X</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="infrastructure.html">Infrastructure</a></li>
      <li class="breadcrumb-item active">Runtime Parameters Unit</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/RuntimeParameters.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="runtime-parameters-unit">
<span id="chp-runtime-parameters-unit"></span><h1>Runtime Parameters Unit<a class="headerlink" href="#runtime-parameters-unit" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">RuntimeParameters</span></code> Unit stores and maintains a global linked
lists of runtime parameters that are used during program execution.
Runtime parameters can be added to the lists, have their values
modified, and be queried. This unit handles adding the default runtime
parameters to the lists as well as reading any overwritten parameters
from the <code class="docutils literal notranslate"><span class="pre">flash.par</span></code> file.</p>
<section id="defining-runtime-parameters">
<h2>Defining Runtime Parameters<a class="headerlink" href="#defining-runtime-parameters" title="Link to this heading"></a></h2>
<p>All parameters must be declared in a <code class="docutils literal notranslate"><span class="pre">Config</span></code> file with the keyword
declaration <code class="docutils literal notranslate"><span class="pre">PARAMETER</span></code>. In the <code class="docutils literal notranslate"><span class="pre">Config</span></code> file, assign a data type
and a default value for the parameter. If possible, assign a range of
valid values for the parameter. You can also provide a short description
of the parameter’s function in a comment line that begins with D.</p>
<div class="shrink docutils container">
<div class="codeseg docutils container">
<p>#section of Config file for a Simulation D myParameter Description
of myParameter PARAMETER myParameter REAL 22.5 [20 to 60]</p>
</div>
</div>
<p>To change the runtime parameter’s value from the default, assign a new
value in the flash.par for the simulation.</p>
<div class="shrink docutils container">
<div class="codeseg docutils container">
<p>#snippet from a flash.par myParameter = 45.0</p>
</div>
</div>
<p>See for more information on declaring parameters in a <code class="docutils literal notranslate"><span class="pre">Config</span></code> file.</p>
</section>
<section id="identifying-valid-runtime-parameters">
<h2>Identifying Valid Runtime Parameters<a class="headerlink" href="#identifying-valid-runtime-parameters" title="Link to this heading"></a></h2>
<p>The values of runtime parameters are initialized either from default
values defined in the <code class="docutils literal notranslate"><span class="pre">Config</span></code> files, or from values explicitly set in
the file <code class="docutils literal notranslate"><span class="pre">flash.par</span></code>. Variables that have been changed from default
are noted in the simulation’s output log. For example, the
RuntimeParameters section of the output log shown in indicates that
<code class="docutils literal notranslate"><span class="pre">Particles/pt_numx</span></code> and <code class="docutils literal notranslate"><span class="pre">Particles/pt_numy</span></code> have been read in from
<code class="docutils literal notranslate"><span class="pre">flash.par</span></code> and are different than the default values, whereas the
runtime parameter <code class="docutils literal notranslate"><span class="pre">IO/checkpointFileIntervalStep</span></code> has been left at the
default value of 0.</p>
<div class="fcodeseg docutils container">
<p>RuntimeParameters:
======================================================= pt_numx = 10
[CHANGED] pt_numy = 5 [CHANGED] checkpointfileintervalstep = 0</p>
</div>
<p>After a simulation has been configured with a <code class="docutils literal notranslate"><span class="pre">setup</span></code> call, all
possible valid runtime parameters are listed in the file
<code class="docutils literal notranslate"><span class="pre">setup_params</span></code> located in the <code class="docutils literal notranslate"><span class="pre">object</span></code> directory (or whatever
directory was chosen with <code class="docutils literal notranslate"><span class="pre">-objdir=</span></code>) with their default values. This
file groups the runtime parameters according to the units with which
they are associated and in alphabetical order. A short description of
the runtime parameter, and the valid range or values if known, are also
given. See for an example listing.</p>
<div class="fcodeseg docutils container">
<p>physics/Eos/EosMain/Multigamma gamma [REAL] [1.6667] Valid Values:
Unconstrained Ratio of specific heats for gas</p>
<p>physics/Hydro/HydroMain cfl [REAL] [0.8] Valid Values: Unconstrained
Courant factor</p>
</div>
</section>
<section id="routine-descriptions">
<h2>Routine Descriptions<a class="headerlink" href="#routine-descriptions" title="Link to this heading"></a></h2>
<p>The Runtime Parameters unit is included by default in all of the
provided Flash-X simulation examples, through a dependence within the
<code class="docutils literal notranslate"><span class="pre">Driver</span></code> unit. The main Flash-X initialization routine
(<code class="docutils literal notranslate"><span class="pre">Driver/Driver_initFlash</span></code>) and the initialization code created by
<code class="docutils literal notranslate"><span class="pre">setup</span></code> handles the creation and initialization of the runtime
parameters, so users will mainly be interested in querying parameter
values. Because the RuntimeParameters routines are overloaded functions
which can handle character, real, integer, or logical arguments, the
user <em>must</em> make sure to <code class="docutils literal notranslate"><span class="pre">use</span></code> the interface file
<code class="docutils literal notranslate"><span class="pre">RuntimeParameters_Interfaces</span></code> in the calling routines.</p>
<p>The user will typically only have to use one routine from the Runtime
Parameters API, <code class="docutils literal notranslate"><span class="pre">RuntimeParameters/RuntimeParameters_get</span></code>. This
routine retrieves the value of a parameter stored in the linked list in
the <code class="docutils literal notranslate"><span class="pre">RuntimeParameters_data</span></code> module. In Flash-X the value of runtime
parameters for a given unit are stored in that unit’s <code class="docutils literal notranslate"><span class="pre">Unit_data</span></code>
Fortran module and they are typically initialized in the unit’s
<code class="docutils literal notranslate"><span class="pre">Unit_init</span></code> routine. Each unit’s ’init’ routine is only called once at
the beginning of the simulation by <code class="docutils literal notranslate"><span class="pre">Driver/Driver_initFlash</span></code>. For more
documentation on the Flash-X code architecture please see . It is
important to note that even though runtime parameters are declared in a
specific unit’s <code class="docutils literal notranslate"><span class="pre">Config</span></code> file, the runtime parameters linked list is a
global space and so any unit can fetch a parameter, even if that unit
did not declare it. For example, the <code class="docutils literal notranslate"><span class="pre">Driver</span></code> unit declares the
logical parameter <code class="docutils literal notranslate"><span class="pre">restart</span></code>, however, many units, including the <code class="docutils literal notranslate"><span class="pre">IO</span></code>
unit get <code class="docutils literal notranslate"><span class="pre">restart</span></code> parameter with the
<code class="docutils literal notranslate"><span class="pre">RuntimeParameters/RuntimeParameters_get</span></code> interface. If a section of
the code asks for a runtime parameter that was not declared in a
<code class="docutils literal notranslate"><span class="pre">Config</span></code> file and thus is not in the runtime parameters linked list,
the Flash-X code will call <code class="docutils literal notranslate"><span class="pre">Driver/Driver_abortFlash</span></code> and stamp an
error to the <code class="docutils literal notranslate"><span class="pre">logfile</span></code>. The other RuntimeParameter routines in the API
are not generally called by user routines. They exist because various
other units within Flash-X need to access parts of the RuntimeParameters
interface. For example, the input/output unit <code class="docutils literal notranslate"><span class="pre">IO</span></code> needs
<code class="docutils literal notranslate"><span class="pre">RuntimeParameters/RuntimeParameters_set</span></code>. There are no user-defined
parameters which affect the <code class="docutils literal notranslate"><span class="pre">RuntimeParameters</span></code> unit.</p>
</section>
<section id="example-usage">
<h2>Example Usage<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h2>
<p>An implementation example from the <code class="docutils literal notranslate"><span class="pre">IO/IO_init</span></code> is straightforward.
First, use the module containing definitions for the unit (for <code class="docutils literal notranslate"><span class="pre">_init</span></code>
subroutines, the usual <code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">Unit_data,</span> <span class="pre">ONLY:</span></code> structure is waived).
Next, use the module containing interface definitions of the
<code class="docutils literal notranslate"><span class="pre">RuntimeParameters</span></code> unit, <em>i.e.</em>,
<code class="docutils literal notranslate"><span class="pre">use</span> <span class="pre">RuntimeParameters_interface,</span> <span class="pre">ONLY:</span></code>. Finally, read the runtime
parameters and store them in unit-specific variables.</p>
<div class="codeseg docutils container">
<p>subroutine IO_init()</p>
<p>use IO_data use RuntimeParamters_interface, ONLY :
RuntimeParameters_get implicit none</p>
<p>call RuntimeParameters_get(’plotFileNumber’,io_plotFileNumber) call
RuntimeParameters_get(’checkpointFileNumber’,io_checkpointFileNumber)</p>
<p>call
RuntimeParameters_get(’plotFileIntervalTime’,io_plotFileIntervalTime)
call
RuntimeParameters_get(’plotFileIntervalStep’,io_plotFileIntervalStep)
call
RuntimeParameters_get(’checkpointFileIntervalTime’,io_checkpointFileIntervalTime)
call
RuntimeParameters_get(’checkpointFileIntervalStep’,io_checkpointFileIntervalStep)</p>
<p>!! etc …</p>
</div>
<p>Note that the parameters found in the <code class="docutils literal notranslate"><span class="pre">flash.par</span></code> or in the <code class="docutils literal notranslate"><span class="pre">Config</span></code>
files, for example <code class="docutils literal notranslate"><span class="pre">IO/plotFileNumber</span></code>, are generally stored in a
variable of the same name with a unit prefix prepended, for example
<code class="docutils literal notranslate"><span class="pre">io_plotFileNumber</span></code>. In this way, a program segment clearly indicates
the origin of variables. Variables with a unit prefix (<em>e.g.</em>, <code class="docutils literal notranslate"><span class="pre">io_</span></code>
for <code class="docutils literal notranslate"><span class="pre">IO</span></code>, <code class="docutils literal notranslate"><span class="pre">pt_</span></code> for particles) have been initialized from the
<code class="docutils literal notranslate"><span class="pre">RuntimeParameters</span></code> database, and other variables are locally
declared. When creating new simulations, runtime parameters used as
variables should be prefixed with <code class="docutils literal notranslate"><span class="pre">sim_</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="IO.html" class="btn btn-neutral float-left" title="IO Unit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Multispecies.html" class="btn btn-neutral float-right" title="Multispecies Unit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Flash-X Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>