<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hydrodynamics Units &mdash; Flash-X 0.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Incompressible Navier-Stokes Unit" href="IncompNS.html" />
    <link rel="prev" title="Physics Units" href="physics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Flash-X
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="disclaimers.html">Current Status and Disclaimers</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="arch.html">Overview of Flash-X architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">The Flash-X configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="driver.html">Driver Unit</a></li>
<li class="toctree-l1"><a class="reference internal" href="infrastructure.html">Infrastructure</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="physics.html">Physics Units</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hydrodynamics Units</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gas-hydrodynamics">Gas hydrodynamics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-unsplit-hydro-solver">The unsplit hydro solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="IncompNS.html">Incompressible Navier-Stokes Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Eos.html">Equation of State Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="sourceTerms.html">Local Source Terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Gravity.html">Gravity Unit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Particles.html">Particles Unit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="monitor.html">Monitor Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_section.html">Developer’s Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flash-X</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="physics.html">Physics Units</a></li>
      <li class="breadcrumb-item active">Hydrodynamics Units</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Hydro.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hydrodynamics-units">
<span id="chp-hydrodynamics-unit"></span><h1>Hydrodynamics Units<a class="headerlink" href="#hydrodynamics-units" title="Permalink to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">Hydro</span></code> unit solves Euler’s equations for compressible gas
dynamics in one, two, or three spatial dimensions. We first describe the
basic functionality; see implementation sections below for various
extensions.</p>
<p>The Euler equations can be written in conservative form as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
{{\partial \rho} \over {\partial t}}
 + {\bf \nabla} \cdot \left ( \rho {\bf v} \right ) &amp; = &amp; 0\\
{\partial \rho {\bf v} \over \partial t} +
 {\bf \nabla}  \cdot \left ( \rho {\bf v} {\bf v} \right ) +
 {\bf \nabla}  P
 &amp; = &amp; \rho {\bf g}\\
{\partial \rho E \over \partial t} +
 {\bf \nabla} \cdot \left [ \left ( \rho E + P \right ) {\bf v}
 \right ] &amp; = &amp;
 \rho {\bf v} \cdot {\bf g}\ ,\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the fluid density, <span class="math notranslate nohighlight">\({\bf v}\)</span> is the fluid
velocity, <span class="math notranslate nohighlight">\(P\)</span> is the pressure, <span class="math notranslate nohighlight">\(E\)</span> is the sum of the
internal energy <span class="math notranslate nohighlight">\(\epsilon\)</span> and kinetic energy per unit mass,</p>
<div class="math notranslate nohighlight">
\[E = \epsilon + {1 \over 2} |{\bf v}|^2\ ,\]</div>
<p><span class="math notranslate nohighlight">\({\bf g}\)</span> is the acceleration due to gravity, and <span class="math notranslate nohighlight">\(t\)</span> is the
time coordinate. The pressure is obtained from the energy and density
using the equation of state. For the case of an ideal gas equation of
state, the pressure is given by</p>
<div class="math notranslate nohighlight">
\[P = (\gamma - 1) \rho \epsilon\ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma\)</span> is the ratio of specific heats. More general
equations of state are discussed in and .</p>
<p>In regions where the kinetic energy greatly dominates the total energy,
computing the internal energy using</p>
<div class="math notranslate nohighlight">
\[\label{Eqn:intener} \epsilon = E - \frac{1}{2}|{\bf v}|^2\]</div>
<p>can lead to unphysical values, primarily due to truncation error. This
results in inaccurate pressures and temperatures. To avoid this problem,
we can separately evolve the internal energy according to</p>
<div class="math notranslate nohighlight">
\[\label{Eqn:evolve_eint}
   \frac{\partial \rho \epsilon}{\partial t}
   + \nabla \cdot \left [ \left (\rho \epsilon + P \right){\bf v} \right ]
   - {\bf v}\cdot \nabla P = 0\ .\]</div>
<p>If the internal energy is a small fraction of the kinetic energy
(determined via the runtime parameter <code class="docutils literal notranslate"><span class="pre">Eos/eintSwitch</span></code>), then the
total energy is recomputed using the internal energy from
<a class="reference external" href="#Eqn:evolve_eint">[Eqn:evolve_eint]</a> and the velocities from the
momentum equation. Numerical experiments using the PPM solver included
with Flash-X showed that using <a class="reference external" href="#Eqn:evolve_eint">[Eqn:evolve_eint]</a>
when the internal energy falls below <span class="math notranslate nohighlight">\(10^{-4}\)</span> of the kinetic
energy helps avoid the truncation errors while not affecting the
dynamics of the simulation.</p>
<p>For reactive flows, a separate advection equation must be solved for
each chemical or nuclear species</p>
<div class="math notranslate nohighlight">
\[{{\partial \rho X_\ell} \over {\partial t}}
+ {\bf \nabla} \cdot \left ( \rho X_\ell {\bf v} \right ) = 0\ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(X_\ell\)</span> is the mass fraction of the <span class="math notranslate nohighlight">\(\ell\)</span>th
species, with the constraint that <span class="math notranslate nohighlight">\(\sum_\ell X_\ell = 1\)</span>. Flash-X
will enforce this constraint if you set the runtime parameter
<code class="docutils literal notranslate"><span class="pre">irenorm</span></code> equal to 1. Otherwise, Flash-X will only restrict the
abundances to fall between <code class="docutils literal notranslate"><span class="pre">smallx</span></code> and 1. The quantity
<span class="math notranslate nohighlight">\(\rho X_\ell\)</span> represents the partial density of the
<span class="math notranslate nohighlight">\(\ell\)</span>th fluid. The code does not explicitly track interfaces
between the fluids, so a small amount of numerical mixing can be
expected during the course of a calculation.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hydro</span></code> unit has a capability to advect mass scalars. Mass scalars
are field variables advected with density, similar to species mass
fractions,</p>
<div class="math notranslate nohighlight">
\[\label{eq:massscalar}
{{\partial \rho \phi_\ell} \over {\partial t}}
+ {\bf \nabla} \cdot \left ( \rho \phi_\ell {\bf v} \right ) = 0\ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi_\ell\)</span> is the <span class="math notranslate nohighlight">\(\ell\)</span>th mass scalar. Note that
mass scalars are optional variables; to include them specify the name of
each mass scalar in a <code class="docutils literal notranslate"><span class="pre">Config</span></code> file using the <code class="docutils literal notranslate"><span class="pre">MASS_SCALAR</span></code> keyword.
Mass scalars are not renormalized in order to sum to 1, except when they
are declared to be part of a renormalization group. See for more
details.</p>
<section id="gas-hydrodynamics">
<h2>Gas hydrodynamics<a class="headerlink" href="#gas-hydrodynamics" title="Permalink to this heading"></a></h2>
<section id="usage">
<span id="sec-ppm-usage"></span><h3>Usage<a class="headerlink" href="#usage" title="Permalink to this heading"></a></h3>
<p>The two gas hydrodynamic solvers supplied in the release of Flash-X are
organized into two different operator splitting methods: directionally
split and unsplit. The directionally split piecewise-parabolic method
(PPM) makes use of second-order Strang time splitting, and the new
directionally unsplit solver is based on Monotone Upstream-centered
Scheme for Conservation Laws (MUSCL) Hancock type second-order scheme.</p>
<p>The algorithms are described in and and implemented in the directory
tree under <code class="docutils literal notranslate"><span class="pre">physics/Hydro/HydroMain/split/PPM</span></code> and
<code class="docutils literal notranslate"><span class="pre">physics/Hydro/HydroMain/unsplit/Hydro_Unsplit</span></code>.</p>
<p>Current and future implementations of <code class="docutils literal notranslate"><span class="pre">Hydro</span></code> use the runtime
parameters and solution variables described in and . Additional runtime
parameters used either solely by the PPM method or the unsplit hydro
solver are described in <code class="docutils literal notranslate"><span class="pre">Hydro/HydroMain</span></code>.</p>
<div class="center docutils container">
<div class="docutils container" id="tab-hydro-parameters">
<p>(<code class="docutils literal notranslate"><span class="pre">Hydro</span></code>) unit.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">eintSwitch</span></code></p></td>
<td><p>real</p></td>
<td><p>0</p></td>
<td><p>If
:math:<a href="#id1"><span class="problematic" id="id2">`</span></a>epsil
on &lt; {tt eintSwitch}</p>
<blockquote>
<div><p>cdot {1</p>
</div></blockquote>
<p>over 2}|{bf v}|^2`,
use the internal
energy equation to
update the pressure</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">irenorm</span></code></p></td>
<td><p>integer</p></td>
<td><p>0</p></td>
<td><p>If equal to one,
renormalize
multifluid abundances
following a hydro
update; else restrict
their values to lie
between <code class="docutils literal notranslate"><span class="pre">smallx</span></code>
and 1.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cfl</span></code></p></td>
<td><p>real</p></td>
<td><p>0.8</p></td>
<td><p>Co
urant-Friedrichs-Lewy
(CFL) factor; must be
less than 1 for
stability in explicit
schemes</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<div class="center docutils container">
<div class="docutils container" id="tab-hydro-variables">
<p>(<code class="docutils literal notranslate"><span class="pre">Hydro</span></code>) unit.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dens</span></code></p></td>
<td><p>PER_VOLUME</p></td>
<td><p>density</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">velx</span></code></p></td>
<td><p>PER_MASS</p></td>
<td><p><span class="math notranslate nohighlight">\(x\)</span>-component of velocity</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vely</span></code></p></td>
<td><p>PER_MASS</p></td>
<td><p><span class="math notranslate nohighlight">\(y\)</span>-component of velocity</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">velz</span></code></p></td>
<td><p>PER_MASS</p></td>
<td><p><span class="math notranslate nohighlight">\(z\)</span>-component of velocity</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pres</span></code></p></td>
<td><p>GENERIC</p></td>
<td><p>pressure</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ener</span></code></p></td>
<td><p>PER_MASS</p></td>
<td><p>specific total energy (<span class="math notranslate nohighlight">\(T+U\)</span>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">temp</span></code></p></td>
<td><p>GENERIC</p></td>
<td><p>temperature</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
</section>
<section id="the-unsplit-hydro-solver">
<span id="sec-muscl-hancock"></span><h3>The unsplit hydro solver<a class="headerlink" href="#the-unsplit-hydro-solver" title="Permalink to this heading"></a></h3>
<p>A directionally unsplit pure hydrodynamic solver (unsplit hydro) is an
alternate gas dynamics solver to the split PPM scheme. The method
basically adopts a predictor-corrector type formulation (zone-edge
data-extrapolated method) that provides second-order solution accuracy
for smooth flows and first-order accuracy for shock flows in both space
and time. Recently, the order of spatial accuracy in data reconstruction
for the normal direction has been extended to implement the 3rd order
PPM and 5th order Weighted ENO (WENO) methods. This unsplit hydro solver
can be considered as a reduced version of the Unsplit Staggered Mesh
(USM) MHD solver (see details in ) that has been available in previous
Flash-X releases.</p>
<p>The unsplit hydro implementation can solve 1D, 2D and 3D problems with
added capabilities of exploring various numerical implementations:
different types of Riemann solvers; slope limiters; first, second, third
and fifth reconstruction methods; a strong shock/rarefaction detection
algorithm as well as two different entropy fix routines for Roe’s
linearized Riemann solver.</p>
<p>One of the notable features of the unsplit hydro scheme is that it
particularly improves the preservation of flow symmetries as compared to
the splitting formulation. Also, the scheme used in this unsplit
algorithm can take a wide range of CFL stability limits (e.g., CFL
<span class="math notranslate nohighlight">\(&lt;\)</span> 1) for all three dimensions, which is based on using upwinded
transverse flux formulations developed in the multidimensional USM MHD
solver (Lee, 2006; Lee and Deane, 2009; Lee, 2013).</p>
<div class="center docutils container">
<div class="docutils container" id="tab-unsplit-hydro-parameters">
<p>Schemes* in the unsplit hydro solver
(<code class="docutils literal notranslate"><span class="pre">physics/Hydro/HydroMain/unsplit/Hydro_Unsplit</span></code>)</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">order</span></code></p></td>
<td><p>integer</p></td>
<td><p>2</p></td>
<td><p>Order of method in
data reconstruction:
1st order Godunov
(FOG), 2nd order
MUSCL-Hancock (MH),
3rd order PPM, 5th
order WENO.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">transOrder</span></code></p></td>
<td><p>integer</p></td>
<td><p>1</p></td>
<td><p>Interpolation order
of accuracy of
taking upwind biased
transverse flux
derivatives in the
unsplit data
reconstruction: 1st,
2nd, 3rd. The choice
of using
<code class="docutils literal notranslate"><span class="pre">transOrder</span></code>=4
adopts a slope
limiter between the
1st and 3rd order
accurate methods to
minimize
oscillations in
upwinding at
discontinuities.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">slopeLimiter</span></code></p></td>
<td><p>string</p></td>
<td><p>“vanLeer”</p></td>
<td><p>Slope limiter:
“MINMOD”, “MC”,
“VANLEER”, “HYBRID”,
“LIMITED”</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LimitedSlopeBeta</span></code></p></td>
<td><p>real</p></td>
<td><p>1.0</p></td>
<td><p>Slope parameter
specific for the
“LIMITED” slope by
Toro</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">charLimiting</span></code></p></td>
<td><p>logical</p></td>
<td><p>.true.</p></td>
<td><p>Enable/disable
limiting on
characteristic
variables (.false.
will use limiting on
primitive variables)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">use_steepening</span></code></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>Enable/disable
contact
discontinuity
steepening for PPM
and WENO</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_flattening</span></code></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>Enable/disable
flattening (or
reducing) numerical
oscillations for MH,
PPM, and WENO</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">use_avisc</span></code></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>Enable/disable
artificial viscosity
for FOG, MH, PPM,
and WENO</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cvisc</span></code></p></td>
<td><p>real</p></td>
<td><p>0.1</p></td>
<td><p>Artificial viscosity
coefficient</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">use_upwindTVD</span></code></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>Enable/disable
upwinded TVD slope
limiter PPM. NOTE:
This requires
NGUARD=6</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_hybridOrder</span></code></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>Enable an adaptively
varying
reconstruction order
scheme reducing its
order from a
high-order to
first-order
depending on
monotonicity
constraints</p></td>
</tr>
<tr class="row-odd"><td><p>``
use_gravHalfUpdate``</p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>On/off gravitational
acceleration source
terms at the half
time Riemann state
update</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">use_3dFullCTU</span></code></p></td>
<td><p>logical</p></td>
<td><p>.true.</p></td>
<td><p>Enable a full CTU
(e.g., similar to
the standard
12-Riemann solve)
algorithm that
provides full CFL
stability in 3D. If
.false., then the
theoretical CFL
bound for 3D becomes
less than 0.5 based
on the linear
Fourier analysis.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<div class="center docutils container">
<div class="docutils container" id="tab-unsplit-hydro-parameters-riemann">
<p>the unsplit hydro solver
(<code class="docutils literal notranslate"><span class="pre">physics/Hydro/HydroMain/unsplit/Hydro_Unsplit</span></code>)</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>`
<cite>RiemannSolver`</cite></p></td>
<td><p>string</p></td>
<td><p>“Roe”</p></td>
<td><p>Different
choices for
Riemann solver.
“LLF (local
L
ax-Friedrichs)”,
“HLL”, “HLLC”,
“HYBRID”, “ROE”,
and “Marquina”</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">shockDetect</span></code></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>On/off
attempting to
detect strong
sho
cks/rarefactions
(and saving flag
in <code class="docutils literal notranslate"><span class="pre">&quot;shok&quot;</span></code>
variable)</p></td>
</tr>
<tr class="row-even"><td><p>`
<cite>shockLowerCFL`</cite></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>On/off lowering
of CFL factor
where strong
shocks are
detected,
automatically
sets
<code class="docutils literal notranslate"><span class="pre">shockDetect</span></code>
if on.</p></td>
</tr>
<tr class="row-odd"><td><p>`
<cite>EOSforRiemann`</cite></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>Enable/disable
calling EOS in
computing each
Godunov flux</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code></p></td>
<td><p>logical</p></td>
<td><p>.false.</p></td>
<td><p>On/off entropy
fix algorithm
for Roe solver</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">en</span>
<span class="pre">tropyFixMethod</span></code></p></td>
<td><p>string</p></td>
<td><p>`
<cite>“HARTENHYMAN”`</cite></p></td>
<td><p>Entropy fix
method for the
Roe solver.
“HARTEN”,
“HARTENHYMAN”</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<p>The above set of runtime parameters provide various types of different
combinations that help in obtaining numerical accuracy, efficiency and
stability. However, there are some important tips users should know
before using them.</p>
<ul>
<li><p>[Extended stencil]: When <code class="docutils literal notranslate"><span class="pre">NGUARD=6</span></code> is used, users should also use
<code class="docutils literal notranslate"><span class="pre">nxb,</span> <span class="pre">nyb</span></code>, and <code class="docutils literal notranslate"><span class="pre">nzb</span></code> larger than <code class="docutils literal notranslate"><span class="pre">2*NGUARD</span></code>. For example,
specifying <code class="docutils literal notranslate"><span class="pre">-nxb=16</span></code> in the setup works well for 1D cases. Once
setting up <code class="docutils literal notranslate"><span class="pre">NGUARD=6</span></code>, users still can use FOG, MH, PPM, or WENO
without changing <code class="docutils literal notranslate"><span class="pre">NGUARD</span></code> back to 4.</p></li>
<li><p>[<code class="docutils literal notranslate"><span class="pre">transOrder</span></code>]: The first order method <code class="docutils literal notranslate"><span class="pre">transOrder=1</span></code> is a
default and only supported method that is stable according to the
linear Fourier stability analysis. The choices for higher-order
interpolations are no longer available in this release.</p></li>
<li><p>[<code class="docutils literal notranslate"><span class="pre">EOSforRiemann</span></code>]: <code class="docutils literal notranslate"><span class="pre">EOSforRiemann</span> <span class="pre">=</span> <span class="pre">.true.</span></code> will call (expensive)
EOS routines to compute consistent adiabatic indices (<em>i.e.</em>,
<code class="docutils literal notranslate"><span class="pre">gamc,</span> <span class="pre">game</span></code>) according to the given left and right states in
Riemann solvers. For the ideal gamma law, in which those adiabatic
indices are constant, it is not required to call EOS at all and users
can set it <code class="docutils literal notranslate"><span class="pre">.false.</span></code> to reduce computation time. On the other hand,
for a degenerate gas, one can enable this switch to compute
thermodynamically consistent <code class="docutils literal notranslate"><span class="pre">gamc,</span> <span class="pre">game</span></code>, which in turn are used
to compute the sound speed and internal energy in Riemann flux
calculations. When disabled, interpolations will be used instead to
get approximations of <code class="docutils literal notranslate"><span class="pre">gamc,</span> <span class="pre">game</span></code>. This interpolation method has
been tested and proven to gain significant computational efficiency
and accuracy, giving reliable numerical solutions even for simulating
a degenerate gas.</p></li>
<li><p>[Gravity coupling with Unplit Hydro Solvers]: When gravity is
included in a simulation using the unsplit hydro and MHD solvers,
users can choose to include gravitational source terms in the Riemann
state update at <span class="math notranslate nohighlight">\(n+1/2\)</span> time step (i.e.,
<code class="docutils literal notranslate"><span class="pre">use_gravHalfUpdate</span></code>=.true.). This will provide an improved
second-order accuracy with respect to coupling gravitational
accelerations to hydrodynamics. It should be noted that current
optimized unsplit hydro/MHD codes (<em>e.g.</em>, those selected with
<code class="docutils literal notranslate"><span class="pre">+uhd,</span> <span class="pre">+usm</span></code>) do not support the runtime parameters
<code class="docutils literal notranslate"><span class="pre">use_gravPotUpdate</span></code> and <code class="docutils literal notranslate"><span class="pre">use_gravConsv</span></code> of some previous Flash-X
versions any more.</p></li>
<li><p>[Reduced CTU vs. Full CTU for 3D in the unsplit hydro (UHD) and
staggered mesh (USM) solvers]: <code class="docutils literal notranslate"><span class="pre">use_3dFullCTU</span></code> is a new switch that
enhances a numerical stability for 3D simulations in the unsplit
solvers using the corner transport upwind (CTU) algorithm by Colella.
The unsplit solvers of Flash-X are different from many other shock
capturing codes, in that neither UHD nor USM solvers need
intermediate Riemann solver solutions for updating transverse fluxes
in multidimensional problems. This provides a computational
efficiency because there is a reduced number of calls to Riemann
solvers per cell per time step. The total number of required Riemann
solver solutions are two for 2D and three for 3D (except for extra
Riemann calls for constraint-transport (CT) update in USM). This is
smaller than the usual stabilty requirement in many other codes which
needs four for 2D and twelve for 3D in order to provide a full CFL
limit (<em>i.e.</em>, CFL <span class="math notranslate nohighlight">\(&lt;1\)</span>).</p>
<p>In general for 3D, there is another computationally efficient
approach that only uses six Riemann solutions (aka, 6-CTU) instead of
solving twelve Riemann problems (aka, 12-CTU). In this efficient
6-CTU, however, the numerical stability limit becomes
CFL<span class="math notranslate nohighlight">\(&lt;0.5\)</span>.</p>
<p>For solving 3D problems in UHD and USM, enabling the new switch
<code class="docutils literal notranslate"><span class="pre">use_3dFullCTU=.true.</span></code> (i.e., full-CTU) will make the solution
evolution scheme similar to 12-CTU while requiring to solve three
Riemann problems only (again, except for the CT update in USM). On
the other hand, <code class="docutils literal notranslate"><span class="pre">use_3dFullCTU=.false.</span></code> (i.e., reduced-CTU) will be
similar to the 6-CTU integration algorithm with a reduced CFL limit
(<em>i.e.</em>, CFL <span class="math notranslate nohighlight">\(&lt;0.5\)</span>).</p>
</li>
</ul>
<div class="flashtip docutils container">
<p>The unsplit solver can take a wide range of CFL limits in all three
dimensions (<em>i.e.</em>, CFL <span class="math notranslate nohighlight">\(&lt;\)</span> 1). However, in some circumstances
where there are strong shocks and rarefactions,
<code class="docutils literal notranslate"><span class="pre">shockLowerCFL=.true.</span></code> could be useful to gain more numerical
stability by lowering the CFL accordingly (e.g., default settings
provide 0.45 for 2D and 0.25 for 3D for the Donor scheme). This
approach will automatically revert such reduced stability conditions
to any given original condition set by users when there are no
significant shocks and rarefactions detected.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="physics.html" class="btn btn-neutral float-left" title="Physics Units" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="IncompNS.html" class="btn btn-neutral float-right" title="Incompressible Navier-Stokes Unit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Flash-X Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>